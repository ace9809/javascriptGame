<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <style>
        span {
            position: absolute;
        }
    </style>
    <script type="text/javascript">
        var word = ['에이스 흰수염 루피 조로 상디 마르코 핸콕 나미 우솝 로빈 쵸파 브룩 프랑키 죠즈 미호크 샹크스 비비 티치 로우 베포 카이도우 '];
        wordSplit = word[0].split(" ");
        var score = 0;
        var fail = 10;
        var level = 1;

        function game() {
            var random = makeRandom(wordSplit.length);
            var randomArray = wordSplit[random];
            wordSplit.splice(random,1);
            var secondPannel = document.getElementById("score");
            secondPannel.innerHTML = score;
            var failScore = document.getElementById("fail");
            failScore.innerHTML = fail;
            if(randomArray) {
                var top = makeElement(randomArray);
                document.getElementById('panel').appendChild(top);
            }
            plusTop(failScore);
            if(fail > 0 && score < 30){
                console.log(score);
                setTimeout("game()",1000);
            }else{
                if(fail === 0) {
                    alert('게임 실패');
                }
                else if(score === 30) {
                    alert('게임 성공');
                }
                return 0;
            }
        }

        function makeElement(word) {
            var span = document.createElement('span');
            span.id = word;
            span.innerHTML = word;
            span.style.left = makeRandom(300) + "px";
            span.style.top = "10px";

            return span;
        }

        function plusTop() {
            var panel = document.getElementById("panel");
            var bringSpan = panel.getElementsByTagName("span");
            var overSpan = [];
            for(var i=0; i < bringSpan.length; i++) {
                var move = bringSpan[i].style;
                var check = positionWord(parseInt(move.top)+50, bringSpan[i]);
                console.log("점수는 :" + score);
                if(check == -1){
                    overSpan.push(bringSpan[i]);
                }
                if(score <= 3) {
                    level = 1;
                    console.log("점수가 작아요");
                    move.top = parseInt(move.top) + 20 + "px";
                    difficulty(level);
                }
                else if ( score > 3 && score <= 6 ) {
                    level = 2;
                    move.top = parseInt(move.top) + 40 + "px";
                    difficulty(level);
                }
                else {
                    level = 3;
                    move.top = parseInt(move.top) + 90 + "px";
                    difficulty(level);
                }
            }

            for(var j=0; j< overSpan.length; j++){
                var pannel = document.getElementById('panel');
                pannel.removeChild(overSpan[j]);
                life();
            }
        }

        function positionWord(top) {
            var pannel = document.getElementById('panel');
            if(parseInt(top) > parseInt(pannel.style.height)) {
                return -1;
            }
        }

        function makeRandom(random) {
            var number = Math.random();
            number = number * 10000;
            number = Math.ceil(number);
            number = number % random;
            return number;
        }

        function onKeyDown(event) {
            if(event.keyCode == 13) {
                var pannel = document.getElementById("panel");
                var span1 = pannel.getElementsByTagName("span");
                var textValue = document.getElementById("text");
                for(var i=0; i < span1.length; i++) {
                    if(textValue.value === span1[i].id) {
                        pannel.removeChild(span1[i]);
                        textValue.value = "";
                        scorePlus();
                    }
                }
            }
        }

        function life() {
            var failScore = document.getElementById("fail");
            fail --;
            failScore.innerHTML = fail;
        }
        function scorePlus() {
            var modifyScore = document.getElementById("score");
            score ++;
            modifyScore.innerHTML = score;
        }

        function difficulty() {
            var domLevel = document.getElementById("level");
            var initLevel = domLevel.innerHTML = level;
            return initLevel;

        }

    </script>
</head>
<body>
<div id = "panel" style="width:520px;height:320px;border:1px solid #58FAF4;"></div>
<div style="width:520px;height:300px;border:1px solid #58FAF4;">
    <input type = "button" id="btn" value = "게임시작" onclick = game() ></br>
    <input type = "text" id="text" onKeyDown = "onKeyDown(event);">
    <p>점수 <span id="score"></span> </p>
    <p>실패 <span id="fail"></span> </p>
    <p>레벨 <span id="level"></span> </p>
</div>

</body>
</html>
